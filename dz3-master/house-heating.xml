<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.springframework.org/schema/beans            http://www.springframework.org/schema/beans/spring-beans-2.5.xsd">
  <!-- Factories -->
  <bean id="onewire_device_factory" class="net.sf.dz3.device.sensor.impl.onewire.OwapiDeviceFactory" init-method="start">
    <constructor-arg index="0" value="/dev/ttyUSB0"/>
    <constructor-arg index="1" value="regular"/>
  </bean>
  <bean id="xbee_device_factory" class="net.sf.dz3.device.sensor.impl.xbee.XBeeDeviceFactory" init-method="start">
    <constructor-arg index="0" value="/dev/ttyUSB1"/>
  </bean>
  <!-- MQTT Device Factory -->
  <bean id="mqtt-device-factory" class="net.sf.dz3.view.mqtt.v1.MqttDeviceFactory" destroy-method="powerOff">
    <!-- Broker host -->
    <constructor-arg index="0" value="pi2-1.pi2.raspberry.freehold"/>
    <!-- Root topic - publish -->
    <constructor-arg index="1" value="/hcc/pi2-1"/>
    <!-- Root topic - subscribe -->
    <constructor-arg index="2" value="/hcc/sensor"/>
  </bean>
  <!-- Sensors -->
  <!-- Raspberry Pi sensors -->
  <bean id="temperature_sensor-vcgencmd-pi1-0" class="net.sf.dz3.device.sensor.impl.ShellSensor" init-method="start">
    <constructor-arg index="0" value="pi1-0"/>
    <constructor-arg index="1" value="5000"/>
    <constructor-arg index="2" value="ssh pi1-0 vcgencmd measure_temp|sed -e &quot;s:temp=::;s:'C::;&quot;"/>
  </bean>
  <bean id="temperature_sensor-vcgencmd-pi1-1" class="net.sf.dz3.device.sensor.impl.ShellSensor" init-method="start">
    <constructor-arg index="0" value="pi1-1"/>
    <constructor-arg index="1" value="5000"/>
    <constructor-arg index="2" value="ssh pi1-1 vcgencmd measure_temp|sed -e &quot;s:temp=::;s:'C::;&quot;"/>
  </bean>
  <bean id="temperature_sensor-vcgencmd-pi2-0" class="net.sf.dz3.device.sensor.impl.ShellSensor" init-method="start">
    <constructor-arg index="0" value="pi2-0"/>
    <constructor-arg index="1" value="5000"/>
    <constructor-arg index="2" value="ssh pi2-0 vcgencmd measure_temp|sed -e &quot;s:temp=::;s:'C::;&quot;"/>
  </bean>
  <bean id="temperature_sensor-vcgencmd-pi2-1" class="net.sf.dz3.device.sensor.impl.ShellSensor" init-method="start">
    <constructor-arg index="0" value="pi2-1"/>
    <constructor-arg index="1" value="5000"/>
    <constructor-arg index="2" value="vcgencmd measure_temp|sed -e &quot;s:temp=::;s:'C::;&quot;"/>
  </bean>
  <!-- 1-Wire serial sensors -->
  <bean id="temperature_sensor-C700000044867B28" factory-bean="onewire_device_factory" factory-method="getTemperatureSensor">
    <constructor-arg value="C700000044867B28"/>
  </bean>
  <bean id="temperature_sensor-9100000044C91528" factory-bean="onewire_device_factory" factory-method="getTemperatureSensor">
    <constructor-arg value="9100000044C91528"/>
  </bean>
  <bean id="temperature_sensor-960000027CC03628" factory-bean="onewire_device_factory" factory-method="getTemperatureSensor">
    <constructor-arg value="960000027CC03628"/>
  </bean>
  <bean id="temperature_sensor-500000027CD07C28" factory-bean="onewire_device_factory" factory-method="getTemperatureSensor">
    <constructor-arg value="500000027CD07C28"/>
  </bean>
  <bean id="temperature_sensor-9C0000027CAEEA28" factory-bean="onewire_device_factory" factory-method="getTemperatureSensor">
    <constructor-arg value="9C0000027CAEEA28"/>
  </bean>
  <!-- XBee sensors -->
  <bean id="voltage_sensor-0013A200.4062AC98_A0" factory-bean="xbee_device_factory" factory-method="getTemperatureSensor">
    <constructor-arg value="0013A200.4062AC98:A0"/>
  </bean>
  <!--
  <bean id="voltage_sensor-0013A200.4062AC98_A1"
    factory-bean="xbee_device_factory"
    factory-method="getTemperatureSensor">
    <constructor-arg value="0013A200.4062AC98:A1"/>
  </bean>
  <bean id="voltage_sensor-0013A200.4062AC98_A2"
    factory-bean="xbee_device_factory"
    factory-method="getTemperatureSensor">
    <constructor-arg value="0013A200.4062AC98:A2"/>
  </bean>
  -->
  <bean id="converter_TMP36" class="net.sf.dz3.device.sensor.impl.AnalogConverterTMP36"/>
  <bean id="temperature_sensor-0013A200.4062AC98_A0" class="net.sf.dz3.device.sensor.impl.ConvertingSensor">
    <constructor-arg index="0" ref="voltage_sensor-0013A200.4062AC98_A0"/>
    <constructor-arg index="1" ref="converter_TMP36"/>
    <!--<constructor-arg index="2" value="1.9" />-->
    <constructor-arg index="2" value="1.7"/>
  </bean>
  <!--
  <bean id="temperature_sensor-0013A200.4062AC98_A1"
        class="net.sf.dz3.device.sensor.impl.ConvertingSensor">
    <constructor-arg index="0" ref="voltage_sensor-0013A200.4062AC98_A1" />
    <constructor-arg index="1" ref="converter_TMP36" />
  </bean>
  <bean id="temperature_sensor-0013A200.4062AC98_A2"
        class="net.sf.dz3.device.sensor.impl.ConvertingSensor">
    <constructor-arg index="0" ref="voltage_sensor-0013A200.4062AC98_A2" />
    <constructor-arg index="1" ref="converter_TMP36" />
  </bean>
  -->
  <bean id="voltage_sensor-0013A200.4062AC9A_A0" factory-bean="xbee_device_factory" factory-method="getTemperatureSensor">
    <constructor-arg value="0013A200.4062AC9A:A0"/>
  </bean>
  <bean id="temperature_sensor-0013A200.4062AC9A_A0" class="net.sf.dz3.device.sensor.impl.ConvertingSensor">
    <constructor-arg index="0" ref="voltage_sensor-0013A200.4062AC9A_A0"/>
    <constructor-arg index="1" ref="converter_TMP36"/>
    <constructor-arg index="2" value="0.0"/>
  </bean>
  <bean id="voltage_sensor-0013A200.405D8027_A0" factory-bean="xbee_device_factory" factory-method="getTemperatureSensor">
    <constructor-arg value="0013A200.405D8027:A0"/>
  </bean>
  <bean id="temperature_sensor-0013A200.405D8027_A0" class="net.sf.dz3.device.sensor.impl.ConvertingSensor">
    <constructor-arg index="0" ref="voltage_sensor-0013A200.405D8027_A0"/>
    <constructor-arg index="1" ref="converter_TMP36"/>
    <constructor-arg index="2" value="0.0"/>
  </bean>
  <!-- MQTT sensors -->
  <bean id="mqtt_sensor-380300A279AABA28" factory-bean="mqtt-device-factory" factory-method="getSensor">
    <constructor-arg value="380300A279AABA28"/>
  </bean>
  <bean id="mqtt_sensor-2A0300A27980C028" factory-bean="mqtt-device-factory" factory-method="getSensor">
    <constructor-arg value="2A0300A27980C028"/>
  </bean>
  <!-- Switches -->
  <bean id="switch_F300000007FBA429_0" factory-bean="onewire_device_factory" factory-method="getSwitch">
    <constructor-arg value="F300000007FBA429:0"/>
  </bean>
  <bean id="switch_F300000007FBA429_1" factory-bean="onewire_device_factory" factory-method="getSwitch">
    <constructor-arg value="F300000007FBA429:1"/>
  </bean>
  <bean id="switch_F300000007FBA429_2" factory-bean="onewire_device_factory" factory-method="getSwitch">
    <constructor-arg value="F300000007FBA429:2"/>
  </bean>
  <bean id="switch_F300000007FBA429_3" factory-bean="onewire_device_factory" factory-method="getSwitch">
    <constructor-arg value="F300000007FBA429:3"/>
  </bean>
  <bean id="switch_F300000007FBA429_4" factory-bean="onewire_device_factory" factory-method="getSwitch">
    <constructor-arg value="F300000007FBA429:4"/>
  </bean>
  <bean id="switch_F300000007FBA429_5" factory-bean="onewire_device_factory" factory-method="getSwitch">
    <constructor-arg value="F300000007FBA429:5"/>
  </bean>
  <bean id="switch_F300000007FBA429_6" factory-bean="onewire_device_factory" factory-method="getSwitch">
    <constructor-arg value="F300000007FBA429:6"/>
  </bean>
  <bean id="switch_F300000007FBA429_7" factory-bean="onewire_device_factory" factory-method="getSwitch">
    <constructor-arg value="F300000007FBA429:7"/>
  </bean>
  <bean id="switch_0013A200.402D030D_0" factory-bean="xbee_device_factory" factory-method="getSwitch">
    <constructor-arg value="0013A200.402D030D:D0"/>
  </bean>
  <bean id="switch_0013A200.402D030D_1" factory-bean="xbee_device_factory" factory-method="getSwitch">
    <constructor-arg value="0013A200.402D030D:D1"/>
  </bean>
  <bean id="switch_0013A200.402D030D_2" factory-bean="xbee_device_factory" factory-method="getSwitch">
    <constructor-arg value="0013A200.402D030D:D2"/>
  </bean>
  <bean id="switch_0013A200.402D030D_3" factory-bean="xbee_device_factory" factory-method="getSwitch">
    <constructor-arg value="0013A200.402D030D:D3"/>
  </bean>
  <bean id="switch_0013A200.4055730D_0" factory-bean="xbee_device_factory" factory-method="getSwitch">
    <constructor-arg value="0013A200.4055730D:D0"/>
  </bean>
  <bean id="switch_0013A200.4055730D_1" factory-bean="xbee_device_factory" factory-method="getSwitch">
    <constructor-arg value="0013A200.4055730D:D1"/>
  </bean>
  <bean id="switch_0013A200.4055730D_2" factory-bean="xbee_device_factory" factory-method="getSwitch">
    <constructor-arg value="0013A200.4055730D:D2"/>
  </bean>
  <bean id="switch_0013A200.4055730D_3" factory-bean="xbee_device_factory" factory-method="getSwitch">
    <constructor-arg value="0013A200.4055730D:D3"/>
  </bean>
  <!-- Thermostats -->
  <bean id="pid_controller-server_room" class="net.sf.dz3.controller.pid.SimplePidController">
    <constructor-arg index="0" value="Server Room"/>
    <constructor-arg index="1" value="30.5"/>
    <constructor-arg index="2" value="1"/>
    <constructor-arg index="3" value="0.000002"/>
    <constructor-arg index="4" value="0"/>
    <constructor-arg index="5" value="1.1"/>
  </bean>
  <bean id="thermostat-server_room" class="net.sf.dz3.device.model.impl.ThermostatModel">
    <constructor-arg type="java.lang.String" value="Server Room"/>
    <constructor-arg type="net.sf.dz3.device.sensor.AnalogSensor" ref="temperature_sensor-9C0000027CAEEA28"/>
    <constructor-arg type="net.sf.dz3.controller.pid.AbstractPidController" ref="pid_controller-server_room"/>
  </bean>
  <bean id="pid_controller-vcgencmd-pi1-0" class="net.sf.dz3.controller.pid.SimplePidController">
    <!-- Setpoint -->
    <constructor-arg index="0" value="60"/>
    <!-- P -->
    <constructor-arg index="1" value="1"/>
    <!-- I -->
    <constructor-arg index="2" value="0"/>
    <!-- D -->
    <constructor-arg index="3" value="0"/>
    <!-- Saturation limit -->
    <constructor-arg index="4" value="0"/>
  </bean>
  <bean id="pid_controller-vcgencmd-pi1-1" class="net.sf.dz3.controller.pid.SimplePidController">
    <!-- Setpoint -->
    <constructor-arg index="0" value="60"/>
    <!-- P -->
    <constructor-arg index="1" value="1"/>
    <!-- I -->
    <constructor-arg index="2" value="0"/>
    <!-- D -->
    <constructor-arg index="3" value="0"/>
    <!-- Saturation limit -->
    <constructor-arg index="4" value="0"/>
  </bean>
  <bean id="pid_controller-vcgencmd-pi2-0" class="net.sf.dz3.controller.pid.SimplePidController">
    <!-- Setpoint -->
    <constructor-arg index="0" value="60"/>
    <!-- P -->
    <constructor-arg index="1" value="1"/>
    <!-- I -->
    <constructor-arg index="2" value="0"/>
    <!-- D -->
    <constructor-arg index="3" value="0"/>
    <!-- Saturation limit -->
    <constructor-arg index="4" value="0"/>
  </bean>
  <bean id="pid_controller-vcgencmd-pi2-1" class="net.sf.dz3.controller.pid.SimplePidController">
    <!-- Setpoint -->
    <constructor-arg index="0" value="60"/>
    <!-- P -->
    <constructor-arg index="1" value="1"/>
    <!-- I -->
    <constructor-arg index="2" value="0"/>
    <!-- D -->
    <constructor-arg index="3" value="0"/>
    <!-- Saturation limit -->
    <constructor-arg index="4" value="0"/>
  </bean>
  <bean id="thermostat-vcgencmd-pi1-0" class="net.sf.dz3.device.model.impl.ThermostatModel">
    <constructor-arg index="0" value="//pi1-0"/>
    <constructor-arg index="1" ref="temperature_sensor-vcgencmd-pi1-0"/>
    <constructor-arg index="2" ref="pid_controller-vcgencmd-pi1-0"/>
  </bean>
  <bean id="thermostat-vcgencmd-pi1-1" class="net.sf.dz3.device.model.impl.ThermostatModel">
    <constructor-arg index="0" value="//pi1-1"/>
    <constructor-arg index="1" ref="temperature_sensor-vcgencmd-pi1-1"/>
    <constructor-arg index="2" ref="pid_controller-vcgencmd-pi1-1"/>
  </bean>
  <bean id="thermostat-vcgencmd-pi2-0" class="net.sf.dz3.device.model.impl.ThermostatModel">
    <constructor-arg index="0" value="//pi2-0"/>
    <constructor-arg index="1" ref="temperature_sensor-vcgencmd-pi2-0"/>
    <constructor-arg index="2" ref="pid_controller-vcgencmd-pi2-0"/>
  </bean>
  <bean id="thermostat-vcgencmd-pi2-1" class="net.sf.dz3.device.model.impl.ThermostatModel">
    <constructor-arg index="0" value="//pi2-1"/>
    <constructor-arg index="1" ref="temperature_sensor-vcgencmd-pi2-1"/>
    <constructor-arg index="2" ref="pid_controller-vcgencmd-pi2-1"/>
  </bean>
  <bean id="pid_controller-family_room" class="net.sf.dz3.controller.pid.SimplePidController">
    <constructor-arg index="0" value="Family Room"/>
    <constructor-arg index="1" value="20"/>
    <!-- <constructor-arg index="2" value="-0.65" /> The swing is uncomfortable-->
    <!-- <constructor-arg index="2" value="-1" /> The unit is shortcycling-->
    <constructor-arg index="2" value="-0.8"/>
    <constructor-arg index="3" value="-0.0000008"/>
    <constructor-arg index="4" value="0"/>
    <constructor-arg index="5" value="3"/>
  </bean>
  <bean id="thermostat-family_room" class="net.sf.dz3.device.model.impl.ThermostatModel">
    <constructor-arg type="java.lang.String" value="Family Room"/>
    <constructor-arg type="net.sf.dz3.device.sensor.AnalogSensor" ref="temperature_sensor-C700000044867B28"/>
    <constructor-arg type="net.sf.dz3.controller.pid.AbstractPidController" ref="pid_controller-family_room"/>
  </bean>
  <bean id="pid_controller-theater_left" class="net.sf.dz3.controller.pid.SimplePidController">
    <constructor-arg index="0" value="Theater Room"/>
    <constructor-arg index="1" value="18.5"/>
    <constructor-arg index="2" value="-1.3"/>
    <constructor-arg index="3" value="-0.0000005"/>
    <constructor-arg index="4" value="0"/>
    <constructor-arg index="5" value="3"/>
  </bean>
  <bean id="thermostat-theater_left" class="net.sf.dz3.device.model.impl.ThermostatModel">
    <constructor-arg type="java.lang.String" value="Theater Room"/>
    <constructor-arg type="net.sf.dz3.device.sensor.AnalogSensor" ref="temperature_sensor-960000027CC03628"/>
    <constructor-arg type="net.sf.dz3.controller.pid.AbstractPidController" ref="pid_controller-theater_left"/>
  </bean>
  <bean id="pid_controller-master_bedroom" class="net.sf.dz3.controller.pid.SimplePidController">
    <constructor-arg index="0" value="Master Bedroom"/>
    <constructor-arg index="1" value="20"/>
    <constructor-arg index="2" value="-0.7"/>
    <constructor-arg index="3" value="-0.000002"/>
    <constructor-arg index="4" value="0"/>
    <constructor-arg index="5" value="3"/>
  </bean>
  <bean id="thermostat-master_bedroom" class="net.sf.dz3.device.model.impl.ThermostatModel">
    <constructor-arg type="java.lang.String" value="Master Bedroom"/>
    <constructor-arg type="net.sf.dz3.device.sensor.AnalogSensor" ref="temperature_sensor-0013A200.4062AC9A_A0"/>
    <constructor-arg type="net.sf.dz3.controller.pid.AbstractPidController" ref="pid_controller-master_bedroom"/>
  </bean>
  <bean id="pid_controller-bedroom_se" class="net.sf.dz3.controller.pid.SimplePidController">
    <constructor-arg index="0" value="SE Bedroom"/>
    <constructor-arg index="1" value="20"/>
    <constructor-arg index="2" value="-1.1"/>
    <constructor-arg index="3" value="-0.000002"/>
    <constructor-arg index="4" value="0"/>
    <constructor-arg index="5" value="1"/>
  </bean>
  <bean id="thermostat-bedroom_se" class="net.sf.dz3.device.model.impl.ThermostatModel">
    <constructor-arg type="java.lang.String" value="SE Bedroom"/>
    <constructor-arg type="net.sf.dz3.device.sensor.AnalogSensor" ref="temperature_sensor-0013A200.4062AC98_A0"/>
    <constructor-arg type="net.sf.dz3.controller.pid.AbstractPidController" ref="pid_controller-bedroom_se"/>
  </bean>
  <bean id="pid_controller-bedroom_nw" class="net.sf.dz3.controller.pid.SimplePidController">
    <constructor-arg index="0" value="NW Bedroom"/>
    <constructor-arg index="1" value="16"/>
    <constructor-arg index="2" value="-1"/>
    <constructor-arg index="3" value="-0.000002"/>
    <constructor-arg index="4" value="0"/>
    <constructor-arg index="5" value="3"/>
  </bean>
  <bean id="thermostat-bedroom_nw" class="net.sf.dz3.device.model.impl.ThermostatModel">
    <constructor-arg type="java.lang.String" value="NW Bedroom"/>
    <constructor-arg type="net.sf.dz3.device.sensor.AnalogSensor" ref="temperature_sensor-0013A200.405D8027_A0"/>
    <constructor-arg type="net.sf.dz3.controller.pid.AbstractPidController" ref="pid_controller-bedroom_nw"/>
  </bean>
  <bean id="pid_controller-2A0300A27980C028" class="net.sf.dz3.controller.pid.SimplePidController">
    <constructor-arg index="0" value="20"/>
    <constructor-arg index="1" value="-1"/>
    <constructor-arg index="2" value="-0.000002"/>
    <constructor-arg index="3" value="0"/>
    <constructor-arg index="4" value="3"/>
  </bean>
  <bean id="thermostat-2A0300A27980C028" class="net.sf.dz3.device.model.impl.ThermostatModel">
    <constructor-arg type="java.lang.String" value="Dining Room"/>
    <constructor-arg type="net.sf.dz3.device.sensor.AnalogSensor" ref="mqtt_sensor-2A0300A27980C028"/>
    <constructor-arg type="net.sf.dz3.controller.pid.AbstractPidController" ref="pid_controller-2A0300A27980C028"/>
  </bean>
  <!-- Kitchen -->
  <bean id="pid_controller-kitchen" class="net.sf.dz3.controller.pid.SimplePidController">
    <constructor-arg index="0" value="Master Bedroom"/>
    <constructor-arg index="1" value="20"/>
    <constructor-arg index="2" value="-0.7"/>
    <constructor-arg index="3" value="-0.000002"/>
    <constructor-arg index="4" value="0"/>
    <constructor-arg index="5" value="3"/>
  </bean>
  <bean id="thermostat-kitchen" class="net.sf.dz3.device.model.impl.ThermostatModel">
    <constructor-arg type="java.lang.String" value="Kitchen"/>
    <constructor-arg type="net.sf.dz3.device.sensor.AnalogSensor" ref="mqtt_sensor-380300A279AABA28"/>
    <constructor-arg type="net.sf.dz3.controller.pid.AbstractPidController" ref="pid_controller-kitchen"/>
  </bean>
  <!-- Dampers -->
  <!-- none -->
  <!-- Zone Controllers -->
  <bean id="zone_controller-server-room" class="net.sf.dz3.device.model.impl.SimpleZoneController">
    <constructor-arg type="java.lang.String" value="server room zone controller"/>
    <constructor-arg type="java.util.Set">
      <set>
        <ref bean="thermostat-server_room"/>
        <ref bean="thermostat-vcgencmd-pi1-0"/>
        <ref bean="thermostat-vcgencmd-pi1-1"/>
        <ref bean="thermostat-vcgencmd-pi2-0"/>
        <ref bean="thermostat-vcgencmd-pi2-1"/>
      </set>
    </constructor-arg>
  </bean>
  <bean id="zone_controller-lennox" class="net.sf.dz3.device.model.impl.SimpleZoneController">
    <constructor-arg type="java.lang.String" value="Lennox zone controller"/>
    <constructor-arg type="java.util.Set">
      <set>
        <ref bean="thermostat-family_room"/>
        <ref bean="thermostat-master_bedroom"/>
        <!-- NOTE: this thermostat controls both units -->
        <ref bean="thermostat-2A0300A27980C028"/>
      </set>
    </constructor-arg>
  </bean>
  <bean id="zone_controller-trane" class="net.sf.dz3.device.model.impl.SimpleZoneController">
    <constructor-arg type="java.lang.String" value="Trane zone controller"/>
    <constructor-arg type="java.util.Set">
      <set>
        <ref bean="thermostat-bedroom_se"/>
        <ref bean="thermostat-bedroom_nw"/>
        <ref bean="thermostat-theater_left"/>
        <ref bean="thermostat-kitchen"/>
        <!-- NOTE: this thermostat controls both units -->
        <ref bean="thermostat-2A0300A27980C028"/>
      </set>
    </constructor-arg>
  </bean>
  <!-- HVAC Units -->
  <bean id="unit-server-room" class="net.sf.dz3.device.model.impl.UnitModel">
    <constructor-arg index="0" type="java.lang.String" value="server-room"/>
    <constructor-arg type="net.sf.dz3.device.model.ZoneController" ref="zone_controller-server-room"/>
  </bean>
  <bean id="unit-lennox" class="net.sf.dz3.device.model.impl.UnitModel">
    <constructor-arg index="0" type="java.lang.String" value="Lennox"/>
    <constructor-arg type="net.sf.dz3.device.model.ZoneController" ref="zone_controller-lennox"/>
  </bean>
  <bean id="unit-trane" class="net.sf.dz3.device.model.impl.UnitModel">
    <constructor-arg index="0" type="java.lang.String" value="Trane"/>
    <constructor-arg type="net.sf.dz3.device.model.ZoneController" ref="zone_controller-trane"/>
  </bean>
  <!-- HVAC Unit Splitters -->
  <bean id="splitter-unit-server-room" class="net.sf.dz3.device.model.impl.UnitSignalSplitter">
    <constructor-arg index="0" ref="unit-server-room"/>
  </bean>
  <bean id="splitter-unit-lennox" class="net.sf.dz3.device.model.impl.UnitSignalSplitter">
    <constructor-arg index="0" ref="unit-lennox"/>
  </bean>
  <bean id="splitter-unit-trane" class="net.sf.dz3.device.model.impl.UnitSignalSplitter">
    <constructor-arg index="0" ref="unit-trane"/>
  </bean>
  <bean id="counter-strategy-time-based" class="net.sf.dz3.util.counter.TimeBasedUsage" scope="prototype"/>
  <!-- Usage Counters -->
  <bean id="counter-unit-server-room" class="net.sf.dz3.util.counter.FileUsageCounter">
    <constructor-arg index="0" value="Server Room Fan Runtime"/>
    <constructor-arg index="1" ref="counter-strategy-time-based"/>
    <constructor-arg index="2" ref="splitter-unit-server-room"/>
    <constructor-arg index="3" value="/home/pi/dz/counter-server-room"/>
  </bean>
  <bean id="counter-unit-lennox" class="net.sf.dz3.util.counter.FileUsageCounter">
    <constructor-arg index="0" value="Lennox Runtime"/>
    <constructor-arg index="1" ref="counter-strategy-time-based"/>
    <constructor-arg index="2" ref="splitter-unit-lennox"/>
    <constructor-arg index="3" value="/home/pi/dz/counter-lennox"/>
  </bean>
  <bean id="counter-unit-trane" class="net.sf.dz3.util.counter.FileUsageCounter">
    <constructor-arg index="0" value="Trane Runtime"/>
    <constructor-arg index="1" ref="counter-strategy-time-based"/>
    <constructor-arg index="2" ref="splitter-unit-trane"/>
    <constructor-arg index="3" value="/home/pi/dz/counter-trane"/>
  </bean>
  <!-- HVAC Drivers -->
  <bean id="null-switch-mode" class="net.sf.dz3.device.sensor.impl.NullSwitch">
    <constructor-arg index="0" value="mode switch"/>
  </bean>
  <bean id="hvac_driver-server-room" class="net.sf.dz3.device.actuator.impl.HvacDriverHeatpump" destroy-method="powerOff">
    <!-- mode -->
    <constructor-arg index="0" ref="null-switch-mode"/>
    <!-- reverse -->
    <constructor-arg index="1" value="false"/>
    <!-- running -->
    <constructor-arg index="2" ref="switch_F300000007FBA429_1"/>
    <!-- reverse -->
    <constructor-arg index="3" value="true"/>
    <!-- fan -->
    <constructor-arg index="4" ref="switch_F300000007FBA429_0"/>
    <!-- reverse -->
    <constructor-arg index="5" value="true"/>
  </bean>
  <bean id="hvac_driver-lennox" class="net.sf.dz3.device.actuator.impl.HvacDriverHeatpump" destroy-method="powerOff">
    <!-- mode -->
    <constructor-arg index="0" ref="switch_0013A200.4055730D_2"/>
    <!-- reverse -->
    <constructor-arg index="1" value="true"/>
    <!-- running -->
    <constructor-arg index="2" ref="switch_0013A200.4055730D_1"/>
    <!-- reverse -->
    <constructor-arg index="3" value="false"/>
    <!-- fan -->
    <constructor-arg index="4" ref="switch_0013A200.4055730D_0"/>
    <!-- reverse -->
    <constructor-arg index="5" value="false"/>
  </bean>
  <bean id="hvac_driver-trane" class="net.sf.dz3.device.actuator.impl.HvacDriverHeatpump" destroy-method="powerOff">
    <!-- mode -->
    <constructor-arg index="0" ref="switch_0013A200.402D030D_2"/>
    <!-- reverse -->
    <constructor-arg index="1" value="true"/>
    <!-- running -->
    <constructor-arg index="2" ref="switch_0013A200.402D030D_1"/>
    <!-- reverse -->
    <constructor-arg index="3" value="false"/>
    <!-- fan -->
    <constructor-arg index="4" ref="switch_0013A200.402D030D_0"/>
    <!-- reverse -->
    <constructor-arg index="5" value="false"/>
  </bean>
  <!-- HVAC Controllers -->
  <bean id="hvac_controller-server-room" class="net.sf.dz3.device.actuator.impl.HvacControllerImpl">
    <constructor-arg index="0" type="java.lang.String" value="HVAC Controller for server room fan panel"/>
    <constructor-arg index="1" ref="hvac_driver-server-room"/>
    <constructor-arg index="2" type="java.lang.String" value="cooling"/>
    <constructor-arg index="3" ref="unit-server-room"/>
  </bean>
  <bean id="hvac_controller-lennox" class="net.sf.dz3.device.actuator.impl.HvacControllerImpl">
    <constructor-arg index="0" type="java.lang.String" value="HVAC Controller for Lennox"/>
    <constructor-arg index="1" ref="hvac_driver-lennox"/>
    <constructor-arg index="2" type="java.lang.String" value="heating"/>
    <constructor-arg index="3" ref="unit-lennox"/>
  </bean>
  <bean id="hvac_controller-trane" class="net.sf.dz3.device.actuator.impl.HvacControllerImpl">
    <constructor-arg index="0" type="java.lang.String" value="HVAC Controller for Trane"/>
    <constructor-arg index="1" ref="hvac_driver-trane"/>
    <constructor-arg index="2" type="java.lang.String" value="heating"/>
    <constructor-arg index="3" ref="unit-trane"/>
  </bean>
  <!-- Damper Controllers -->
  <!-- none -->
  <!-- Loggers -->
  <bean id="influxdb-sensors-zx" class="net.sf.dz3.view.influxdb.v1.InfluxDbLogger" init-method="start">
    <constructor-arg index="0" type="java.util.Set">
      <set>
        <ref bean="mqtt_sensor-2A0300A27980C028"/>
        <ref bean="temperature_sensor-0013A200.4062AC9A_A0"/>
        <ref bean="temperature_sensor-0013A200.4062AC98_A0"/>
        <ref bean="temperature_sensor-0013A200.405D8027_A0"/>
        <ref bean="temperature_sensor-500000027CD07C28"/>
        <ref bean="temperature_sensor-9100000044C91528"/>
        <ref bean="temperature_sensor-960000027CC03628"/>
        <ref bean="temperature_sensor-9C0000027CAEEA28"/>
        <ref bean="temperature_sensor-C700000044867B28"/>
        <ref bean="temperature_sensor-vcgencmd-pi1-0"/>
        <ref bean="temperature_sensor-vcgencmd-pi1-1"/>
        <ref bean="temperature_sensor-vcgencmd-pi2-0"/>
        <ref bean="temperature_sensor-vcgencmd-pi2-1"/>
        <ref bean="mqtt_sensor-380300A279AABA28"/>
      </set>
    </constructor-arg>
    <constructor-arg index="1" type="java.lang.String" value="house"/>
    <constructor-arg index="2" type="java.lang.String" value="http://zx:8086/"/>
  </bean>
  <!-- Splitters -->
  <!-- none -->
  <bean id="google-calendar-updater" class="net.sf.dz3.scheduler.gcal.GCalScheduleUpdater">
    <constructor-arg index="0">
      <map>
        <entry>
          <key>
            <ref bean="thermostat-server_room"/>
          </key>
          <value>DZ Schedule: Server Room</value>
        </entry>
        <entry>
          <key>
            <ref bean="thermostat-bedroom_se"/>
          </key>
          <value>DZ Schedule: SE Bedroom</value>
        </entry>
        <entry>
          <key>
            <ref bean="thermostat-bedroom_nw"/>
          </key>
          <value>DZ Schedule: NW Bedroom</value>
        </entry>
        <entry>
          <key>
            <ref bean="thermostat-theater_left"/>
          </key>
          <value>DZ Schedule: Theater Room</value>
        </entry>
        <entry>
          <key>
            <ref bean="thermostat-family_room"/>
          </key>
          <value>DZ Schedule: Family Room</value>
        </entry>
        <entry>
          <key>
            <ref bean="thermostat-master_bedroom"/>
          </key>
          <value>DZ Schedule: Master Bedroom</value>
        </entry>
        <entry>
          <key>
            <ref bean="thermostat-2A0300A27980C028"/>
          </key>
          <value>DZ Schedule: Dining Room</value>
        </entry>
      </map>
    </constructor-arg>
  </bean>
  <bean id="scheduler" class="net.sf.dz3.scheduler.Scheduler" init-method="start">
    <constructor-arg>
      <ref bean="google-calendar-updater"/>
    </constructor-arg>
  </bean>
  <!-- Console -->
  <bean id="console" class="net.sf.dz3.view.swing.Console" init-method="show">
    <constructor-arg index="0" type="java.util.Set">
      <set>
        <!--<ref bean="scheduler" />-->
        <ref bean="thermostat-master_bedroom"/>
        <ref bean="thermostat-server_room"/>
        <ref bean="thermostat-family_room"/>
        <ref bean="thermostat-theater_left"/>
        <ref bean="thermostat-bedroom_se"/>
        <ref bean="thermostat-bedroom_nw"/>
        <ref bean="thermostat-kitchen"/>
        <ref bean="thermostat-2A0300A27980C028"/>
        <ref bean="thermostat-vcgencmd-pi1-0"/>
        <ref bean="thermostat-vcgencmd-pi1-1"/>
        <ref bean="thermostat-vcgencmd-pi2-0"/>
        <ref bean="thermostat-vcgencmd-pi2-1"/>
        <ref bean="zone_controller-server-room"/>
        <ref bean="unit-server-room"/>
        <ref bean="hvac_driver-server-room"/>
        <ref bean="hvac_controller-server-room"/>
        <ref bean="scheduler"/>
      </set>
    </constructor-arg>
  </bean>
  <!-- HTTP Connector v.3 -->
  <bean id="http-connector-appspot-v3" class="net.sf.dz3.view.http.v3.HttpConnector" init-method="activate">
    <constructor-arg index="0" value="https://home-climate-control-v3.appspot.com/v3/data-source"/>
    <constructor-arg index="1" type="java.util.Set">
      <set>
        <ref bean="thermostat-master_bedroom"/>
        <ref bean="thermostat-server_room"/>
        <ref bean="thermostat-family_room"/>
        <ref bean="thermostat-theater_left"/>
        <ref bean="thermostat-bedroom_se"/>
        <ref bean="thermostat-bedroom_nw"/>
        <ref bean="thermostat-kitchen"/>
        <ref bean="thermostat-2A0300A27980C028"/>
        <ref bean="scheduler"/>
      </set>
    </constructor-arg>
  </bean>
  <!-- MQTT Connector -->
  <bean id="mqtt-connector" class="net.sf.dz3.view.mqtt.v1.MqttConnector" init-method="activate">
    <!-- Broker host -->
    <constructor-arg index="0" value="pi1e"/>
    <!-- Root topic  -->
    <constructor-arg index="1" value="/hcc/house"/>
    <!-- Root topic - subscribe -->
    <constructor-arg index="2" value="hass/workshop"/>
    <constructor-arg index="3" type="java.util.Set">
      <set>
        <ref bean="thermostat-master_bedroom"/>
        <ref bean="thermostat-server_room"/>
        <ref bean="thermostat-family_room"/>
        <ref bean="thermostat-theater_left"/>
        <ref bean="thermostat-bedroom_se"/>
        <ref bean="thermostat-bedroom_nw"/>
        <ref bean="thermostat-kitchen"/>
        <ref bean="counter-unit-server-room"/>
        <ref bean="counter-unit-lennox"/>
        <ref bean="counter-unit-trane"/>
      </set>
    </constructor-arg>
  </bean>
  <!-- JMX configuration -->
  <bean id="jmx-wrapper" class="com.homeclimatecontrol.jukebox.jmx.JmxWrapper">
    <constructor-arg index="0" type="java.util.Set">
      <set>
        <ref bean="http-connector-appspot-v3"/>
        <ref bean="temperature_sensor-C700000044867B28"/>
        <ref bean="temperature_sensor-960000027CC03628"/>
        <ref bean="temperature_sensor-9100000044C91528"/>
        <ref bean="temperature_sensor-500000027CD07C28"/>
        <ref bean="temperature_sensor-9C0000027CAEEA28"/>
        <ref bean="mqtt_sensor-2A0300A27980C028"/>
        <ref bean="temperature_sensor-0013A200.4062AC9A_A0"/>
        <ref bean="temperature_sensor-0013A200.4062AC98_A0"/>
        <ref bean="temperature_sensor-0013A200.405D8027_A0"/>
        <ref bean="temperature_sensor-vcgencmd-pi1-0"/>
        <ref bean="temperature_sensor-vcgencmd-pi1-1"/>
        <ref bean="temperature_sensor-vcgencmd-pi2-0"/>
        <ref bean="temperature_sensor-vcgencmd-pi2-1"/>
        <ref bean="rrdlogger_house"/>
        <ref bean="rrdlogger_extra"/>
        <ref bean="onewire_device_factory"/>
        <ref bean="xbee_device_factory"/>
        <ref bean="pid_controller-2A0300A27980C028"/>
        <ref bean="pid_controller-master_bedroom"/>
        <ref bean="pid_controller-server_room"/>
        <ref bean="pid_controller-family_room"/>
        <ref bean="pid_controller-theater_left"/>
        <ref bean="pid_controller-bedroom_se"/>
        <ref bean="pid_controller-bedroom_nw"/>
        <ref bean="thermostat-2A0300A27980C028"/>
        <ref bean="thermostat-master_bedroom"/>
        <ref bean="thermostat-server_room"/>
        <ref bean="thermostat-family_room"/>
        <ref bean="thermostat-theater_left"/>
        <ref bean="thermostat-bedroom_se"/>
        <ref bean="thermostat-bedroom_nw"/>
        <ref bean="thermostat-vcgencmd-pi1-0"/>
        <ref bean="thermostat-vcgencmd-pi1-1"/>
        <ref bean="thermostat-vcgencmd-pi2-0"/>
        <ref bean="thermostat-vcgencmd-pi2-1"/>
        <ref bean="zone_controller-server-room"/>
        <ref bean="unit-server-room"/>
        <ref bean="hvac_driver-server-room"/>
        <ref bean="hvac_controller-server-room"/>
        <ref bean="zone_controller-lennox"/>
        <ref bean="unit-lennox"/>
        <ref bean="hvac_driver-lennox"/>
        <ref bean="hvac_controller-lennox"/>
        <ref bean="zone_controller-trane"/>
        <ref bean="unit-trane"/>
        <ref bean="hvac_driver-trane"/>
        <ref bean="hvac_controller-trane"/>
        <ref bean="scheduler"/>
        <ref bean="google-calendar-updater"/>
        <ref bean="mqtt-connector"/>
        <ref bean="counter-unit-server-room"/>
        <ref bean="counter-unit-lennox"/>
        <ref bean="counter-unit-trane"/>
        <ref bean="influxdb-sensors-zx"/>
      </set>
    </constructor-arg>
  </bean>
</beans>
